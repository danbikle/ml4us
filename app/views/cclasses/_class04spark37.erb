<code class='bash'>
dan@a78:~/sparkapps/logr10 $ spark-shell -i logr12.scala
Spark context Web UI available at http://192.168.1.78:4040
Spark context available as 'sc' (master = local[*], app id = local-1498264064767).
Spark session available as 'spark'.
Loading logr12.scala...
import org.apache.spark.sql.SQLContext
import org.apache.spark.ml.classification.LogisticRegression
import org.apache.spark.ml.linalg.{Vector, Vectors}
import org.apache.spark.ml.param.ParamMap
import org.apache.spark.sql.Row
import sys.process._
warning: there was one feature warning; re-run with -feature for details
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
100 1241k  100 1241k    0     0  1148k      0  0:00:01  0:00:01 --:--:-- 1148k
res2: Int = 0
warning: there was one deprecation warning; re-run with -deprecation for details
sqlContext: org.apache.spark.sql.SQLContext = org.apache.spark.sql.SQLContext@15a591d9
dp10df: org.apache.spark.sql.DataFrame = [Date: timestamp, Open: double ... 5 more fields]
+-----------+--------------------+--------------------+----------+-----------+
|count(Date)|           min(Date)|           max(Date)|min(Close)| max(Close)|
+-----------+--------------------+--------------------+----------+-----------+
|      16978|1950-01-03 00:00:...|2017-06-22 00:00:...|     16.66|2453.459961|
+-----------+--------------------+--------------------+----------+-----------+

sqls: String = SELECT Date,Close,LEAD(Close,1)OVER(ORDER BY Date) leadp FROM tab ORDER BY Date
dp11df: org.apache.spark.sql.DataFrame = [Date: timestamp, Close: double ... 1 more field]
sqls: String = SELECT Date,Close,100*(leadp-Close)/Close pctlead FROM tab ORDER BY Date
dp12df: org.apache.spark.sql.DataFrame = [Date: timestamp, Close: double ... 1 more field]
+--------------------+---------+--------------------+
|                Date|    Close|             pctlead|
+--------------------+---------+--------------------+
|1950-01-03 00:00:...|    16.66|  1.1404561824729968|
|1950-01-04 00:00:...|    16.85|  0.4747774480712065|
|1950-01-05 00:00:...|    16.93| 0.29533372711164035|
|1950-01-06 00:00:...|    16.98|   0.588928150765594|
|1950-01-09 00:00:...|    17.08| -0.2927341920374689|
|1950-01-10 00:00:...|17.030001|  0.3523135436104863|
|1950-01-11 00:00:...|    17.09| -1.9309537741369123|
|1950-01-12 00:00:...|    16.76| -0.5369928400954644|
|1950-01-13 00:00:...|    16.67|  0.2999340131973586|
|1950-01-16 00:00:...|16.719999|  0.8373325859648619|
|1950-01-17 00:00:...|16.860001|-0.05931790869999...|
|1950-01-18 00:00:...|    16.85| 0.11870029673588751|
|1950-01-19 00:00:...|16.870001|  0.1778245300637511|
|1950-01-20 00:00:...|     16.9|  0.1183431952662907|
|1950-01-23 00:00:...|    16.92| -0.3546040189125369|
|1950-01-24 00:00:...|16.860001| -0.7117496612248245|
|1950-01-25 00:00:...|    16.74|-0.05973715651133818|
|1950-01-26 00:00:...|    16.73|  0.5379557680812902|
|1950-01-27 00:00:...|    16.82|  1.1890606420927425|
|1950-01-30 00:00:...|    17.02|  0.1762573443008232|
+--------------------+---------+--------------------+
only showing top 20 rows


Welcome to
      ____              __
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 2.1.1
      /_/
         
Using Scala version 2.11.8 (Java HotSpot(TM) 64-Bit Server VM, Java 1.8.0_131)
Type in expressions to have them evaluated.
Type :help for more information.

scala> 
scala> :quit
</code>
